(this["webpackJsonpweek-progress"]=this["webpackJsonpweek-progress"]||[]).push([[0],{150:function(e,t,n){},151:function(e,t,n){},153:function(e){e.exports=JSON.parse('{"clientId":"1081935285404-2t3rjrjnu7gh4fepokh7fqg9jc5qd354.apps.googleusercontent.com","scope":"https://www.googleapis.com/auth/calendar","discoveryDocs":["https://www.googleapis.com/discovery/v1/apis/calendar/v3/rest"]}')},162:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),s=n(52),r=n.n(s),o=(n(150),n(227)),c=(n(151),n(41)),l=n(113),d=n(59),h=n.n(d),u=n(95),g=n(46),p=n(47),b=n(91),v=n(89),j=n(242),f=n(236),x=n(250),O=n(240),k=n(153),m=new(function(){function e(){Object(g.a)(this,e),this.sign=!1,this.gapi=null,this.onLoadCallback=null,this.calendar="primary";try{this.updateSigninStatus=this.updateSigninStatus.bind(this),this.initClient=this.initClient.bind(this),this.handleSignoutClick=this.handleSignoutClick.bind(this),this.handleAuthClick=this.handleAuthClick.bind(this),this.createEvent=this.createEvent.bind(this),this.listUpcomingEvents=this.listUpcomingEvents.bind(this),this.listEvents=this.listEvents.bind(this),this.listCalendars=this.listCalendars.bind(this),this.createEventFromNow=this.createEventFromNow.bind(this),this.listenSign=this.listenSign.bind(this),this.onLoad=this.onLoad.bind(this),this.setCalendar=this.setCalendar.bind(this),this.updateEvent=this.updateEvent.bind(this),this.deleteEvent=this.deleteEvent.bind(this),this.getEvent=this.getEvent.bind(this),this.getBasicUserProfile=this.getBasicUserProfile.bind(this),this.handleClientLoad()}catch(t){console.log(t)}}return Object(p.a)(e,[{key:"updateSigninStatus",value:function(e){this.sign=e}},{key:"initClient",value:function(){var e=this;this.gapi=window.gapi,this.gapi.client.init(k).then((function(){e.gapi.auth2.getAuthInstance().isSignedIn.listen(e.updateSigninStatus),e.updateSigninStatus(e.gapi.auth2.getAuthInstance().isSignedIn.get()),e.onLoadCallback&&e.onLoadCallback()})).catch((function(e){console.log(e)}))}},{key:"handleClientLoad",value:function(){var e=this;this.gapi=window.gapi;var t=document.createElement("script");t.src="https://apis.google.com/js/api.js",document.body.appendChild(t),t.onload=function(){window.gapi.load("client:auth2",e.initClient)}}},{key:"handleAuthClick",value:function(){return this.gapi?this.gapi.auth2.getAuthInstance().signIn():(console.log("Error: this.gapi not loaded"),Promise.reject(new Error("Error: this.gapi not loaded")))}},{key:"setCalendar",value:function(e){this.calendar=e}},{key:"listenSign",value:function(e){this.gapi?this.gapi.auth2.getAuthInstance().isSignedIn.listen(e):console.log("Error: this.gapi not loaded")}},{key:"onLoad",value:function(e){this.gapi?e():this.onLoadCallback=e}},{key:"handleSignoutClick",value:function(){this.gapi?this.gapi.auth2.getAuthInstance().signOut():console.log("Error: this.gapi not loaded")}},{key:"listUpcomingEvents",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.calendar;return this.gapi?this.gapi.client.calendar.events.list({calendarId:t,timeMin:(new Date).toISOString(),showDeleted:!1,singleEvents:!0,maxResults:e,orderBy:"startTime"}):(console.log("Error: this.gapi not loaded"),!1)}},{key:"listEvents",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.calendar;if(this.gapi)return this.gapi.client.calendar.events.list(Object(c.a)({calendarId:t},e));throw Error("Error: this.gapi not loaded")}},{key:"listCalendars",value:function(e){if(this.gapi)return this.gapi.client.calendar.calendarList.list(Object(c.a)({},e));throw Error("Error: this.gapi not loaded")}},{key:"createEventFromNow",value:function(e){var t=e.time,n=e.summary,a=e.description,i=void 0===a?"":a,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.calendar,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Europe/Paris",o={summary:n,description:i,start:{dateTime:(new Date).toISOString(),timeZone:r},end:{dateTime:new Date((new Date).getTime()+6e4*t),timeZone:r}};return this.createEvent(o,s)}},{key:"createEvent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.calendar,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"none";return this.gapi?this.gapi.client.calendar.events.insert({calendarId:t,resource:e,sendUpdates:n}):(console.log("Error: this.gapi not loaded"),!1)}},{key:"deleteEvent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.calendar;return this.gapi?this.gapi.client.calendar.events.delete({calendarId:t,eventId:e}):(console.log("Error: gapi is not loaded use onLoad before please."),null)}},{key:"getBasicUserProfile",value:function(){return this.gapi?this.gapi.auth2.getAuthInstance().currentUser.get().getBasicProfile():(console.log("Error: gapi is not loaded use onLoad before please."),null)}},{key:"updateEvent",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.calendar,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"none";return this.gapi?this.gapi.client.calendar.events.patch({calendarId:n,eventId:t,resource:e,sendUpdates:a}):(console.log("Error: gapi is not loaded use onLoad before please."),null)}},{key:"getEvent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.calendar;return this.gapi?this.gapi.client.calendar.events.get({calendarId:t,eventId:e}):(console.log("Error: gapi is not loaded use onLoad before please."),null)}}]),e}()),y=n(97),w=n(98),C=n(119),E=n(220),S=n(57),D=n(241),I=n(235),T=n(232),W=n(234),P=n(230),L=n(229),A=n(226),B=n(228),U=n(219),N=n(243),F=n(245),M=n(246),R=n(247),q=n(237),G=n(248),J=n(249),H=n(118),Z=n(122),Y=n(1);function z(e){var t=e.selected?{color:"primary.dark"}:{},n=e.selected?{bgcolor:"primary.dark",color:"white"}:{},a=Math.floor(e.total/60),i=e.total%60,s="".concat(a).padStart(2,"0"),r="".concat(i).padStart(2,"0");return Object(Y.jsxs)(D.a,{sx:Object(c.a)(Object(c.a)({},t),{},{textAlign:"center"}),children:[Object(Y.jsx)(D.a,{children:Object(Y.jsx)(j.a,{variant:"body2",children:Object(Z.a)(e.date,"EEE").toUpperCase()})}),Object(Y.jsx)(D.a,{sx:Object(c.a)(Object(c.a)({},n),{},{borderRadius:"50%",paddingTop:"2px",marginTop:"2px"}),width:38,height:38,margin:"auto",children:Object(Y.jsx)(j.a,{variant:"h6",children:Object(Z.a)(e.date,"d")})}),Object(Y.jsx)(D.a,{sx:{marginTop:"2px"},children:Object(Y.jsxs)(j.a,{variant:"subtitle2",children:[s,":",r]})})]})}function K(e){for(var t=new Date,n=[],a=0;a<7;a++)n.push(Object(S.a)(e.baseDate,a));return Object(Y.jsxs)(N.a,{children:[Object(Y.jsx)(F.a,{action:Object(Y.jsx)(M.a,{"aria-label":"settings",onClick:function(){return e.onRefresh()},children:Object(Y.jsx)(U.a,{})}),title:"Timesheet"}),Object(Y.jsxs)(R.a,{sx:{flexGrow:1},children:[Object(Y.jsx)(D.a,{sx:{flexGrow:1},children:Object(Y.jsx)(q.a,{container:!0,spacing:2,children:n.map((function(n,a){return Object(Y.jsx)(q.a,{item:!0,xs:!0,children:Object(Y.jsx)(z,{date:n,total:e.perDayTotals[a],selected:Object(H.a)(n,t)})})}))})}),Object(Y.jsxs)(D.a,{marginTop:2,children:[Object(Y.jsx)(j.a,{variant:"body1",children:"Progress"}),Object(Y.jsx)(D.a,{marginY:1,children:Object(Y.jsx)(G.a,{variant:e.loading?"indeterminate":"determinate",value:e.doneThisWeek/e.plannedThisWeek*100})}),Object(Y.jsxs)(j.a,{variant:"body2",children:["Planned this week: ",e.loading?"-":e.plannedThisWeek/60," hours",Object(Y.jsx)("br",{}),"So far: ",e.loading?"-":e.doneThisWeek/60," hours"]})]})]}),Object(Y.jsxs)(J.a,{children:[Object(Y.jsx)(x.a,{onClick:function(){return e.onPrevious()},children:"Previous"}),Object(Y.jsx)(x.a,{onClick:function(){return e.onCurrent()},children:"Current"}),Object(Y.jsx)(x.a,{onClick:function(){return e.onNext()},children:"Next"})]})]})}var Q=function(e){Object(b.a)(n,e);var t=Object(v.a)(n);function n(e){var a;return Object(g.a)(this,n),(a=t.call(this,e)).state={sign:m.sign,events:[],doneThisWeek:0,plannedThisWeek:0,perDayTotals:[0,0,0,0,0,0],baseDate:new Date,loading:!0,calendar:void 0,calendars:[]},m.onLoad((function(){m.listenSign((function(e){a.setState({sign:e})}))})),a}return Object(p.a)(n,[{key:"componentDidMount",value:function(){this.fetchCalendars(),this.fetchData()}},{key:"fetchCalendars",value:function(){var e=Object(u.a)(h.a.mark((function e(){var t,n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(m.sign){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,m.listCalendars({});case 5:t=e.sent,n=t.result,console.log(n.items),this.setState({calendars:n.items}),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(2),console.error(e.t0);case 14:case"end":return e.stop()}}),e,this,[[2,11]])})));return function(){return e.apply(this,arguments)}}()},{key:"fetchData",value:function(){var e=Object(u.a)(h.a.mark((function e(){var t,n,a,i,s,r,o,c,d,u,g,p,b,v;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(m.sign){e.next=2;break}return e.abrupt("return");case 2:return this.setState({loading:!0}),t=new Date,e.prev=4,e.next=7,m.listEvents({timeMin:Object(y.a)(this.state.baseDate).toISOString(),timeMax:Object(w.a)(this.state.baseDate).toISOString(),showDeleted:!1,maxResults:10,calendarId:this.state.calendar,singleEvents:!0});case 7:if(n=e.sent,a=n.result,i=0,s=0,r=[0,0,0,0,0,0,0],a.items){o=Object(l.a)(a.items);try{for(o.s();!(c=o.n()).done;)(d=c.value).start&&d.end&&(p=new Date(null===(u=d.start)||void 0===u?void 0:u.dateTime),b=new Date(null===(g=d.end)||void 0===g?void 0:g.dateTime),v=Object(C.a)(b,p),r[b.getDay()]+=v,i+=v,b<t&&(s+=v))}catch(h){o.e(h)}finally{o.f()}}this.setState({plannedThisWeek:i,doneThisWeek:s,perDayTotals:r,loading:!1}),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(4),console.error(e.t0);case 19:case"end":return e.stop()}}),e,this,[[4,16]])})));return function(){return e.apply(this,arguments)}}()},{key:"signIn",value:function(){var e=Object(u.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,m.handleAuthClick();case 3:return e.next=5,this.fetchCalendars();case 5:this.setState({sign:!0}),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0),this.setState({sign:!1});case 12:case"end":return e.stop()}}),e,this,[[0,8]])})));return function(){return e.apply(this,arguments)}}()},{key:"setPreviousWeek",value:function(){var e=this;this.setState({baseDate:Object(E.a)(this.state.baseDate,7)},(function(){e.fetchData()}))}},{key:"setCurrentWeek",value:function(){var e=this;this.setState({baseDate:new Date},(function(){e.fetchData()}))}},{key:"setNextWeek",value:function(){var e=this;this.setState({baseDate:Object(S.a)(this.state.baseDate,7)},(function(){e.fetchData()}))}},{key:"handleCalendarChange",value:function(e){var t=this;this.setState({calendar:e.target.value},(function(){t.fetchData()}))}},{key:"render",value:function(){var e,t=this;return Object(Y.jsxs)(D.a,{sx:{width:"100%",maxWidth:500,margin:"auto",padding:4},children:[Object(Y.jsx)(j.a,{variant:"h3",component:"div",gutterBottom:!0,children:"Week Progress"}),this.state.sign?Object(Y.jsxs)("div",{children:[Object(Y.jsx)(D.a,{sx:{minWidth:120,marginBottom:2},children:Object(Y.jsxs)(W.a,{fullWidth:!0,children:[Object(Y.jsx)(I.a,{id:"demo-simple-select-label",children:"Pick the calendar"}),Object(Y.jsx)(P.a,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:this.state.calendar,label:"Pick the calendar",onChange:function(e){return t.handleCalendarChange(e)},children:null===(e=this.state.calendars)||void 0===e?void 0:e.map((function(e){return Object(Y.jsx)(T.a,{value:e.id,children:e.summary})}))}),Object(Y.jsx)(D.a,{marginBottom:2}),Object(Y.jsx)(A.b,{dateAdapter:L.a,children:Object(Y.jsx)(B.a,{label:"Pick any date",value:this.state.baseDate,onChange:function(e){t.setState({baseDate:new Date(e)})},renderInput:function(e){return Object(Y.jsx)(f.a,Object(c.a)({},e))}})})]})}),this.state.calendar&&Object(Y.jsx)(K,{loading:this.state.loading,baseDate:Object(y.a)(this.state.baseDate),doneThisWeek:this.state.doneThisWeek,plannedThisWeek:this.state.plannedThisWeek,perDayTotals:this.state.perDayTotals,onRefresh:function(){return t.fetchData()},onPrevious:function(){return t.setPreviousWeek()},onCurrent:function(){return t.setCurrentWeek()},onNext:function(){return t.setNextWeek()}})]}):Object(Y.jsx)(x.a,{variant:"contained",onClick:function(){return t.signIn()},children:"Sign in with Google"}),Object(Y.jsxs)(j.a,{variant:"caption",component:"div",paddingTop:4,gutterBottom:!0,children:["Hosted (code + bundle) on ",Object(Y.jsx)(O.a,{href:"https://github.com/pierremtb/week-progress",children:"GitHub"})," \ud83d\udc9b.",Object(Y.jsx)("br",{}),"Copyright \xa9 2021 ",Object(Y.jsx)(O.a,{href:"https://pierrejacquier.com",children:"Pierre Jacquier"}),"."]})]})}}]),n}(i.a.Component);var V=function(){return Object(Y.jsxs)(i.a.Fragment,{children:[Object(Y.jsx)(o.a,{}),Object(Y.jsx)(Q,{})]})},X=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,254)).then((function(t){var n=t.getCLS,a=t.getFID,i=t.getFCP,s=t.getLCP,r=t.getTTFB;n(e),a(e),i(e),s(e),r(e)}))};r.a.render(Object(Y.jsx)(i.a.StrictMode,{children:Object(Y.jsx)(V,{})}),document.getElementById("root")),X()}},[[162,1,2]]]);
//# sourceMappingURL=main.9caeff65.chunk.js.map